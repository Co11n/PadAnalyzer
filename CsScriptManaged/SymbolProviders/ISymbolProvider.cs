using CsScripts;
using System;

namespace CsScriptManaged.SymbolProviders
{
    public interface ISymbolProvider
    {
        /// <summary>
        /// Gets the symbol tag of the specified type.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="typeId">The type identifier.</param>
        SymTag GetTypeTag(Module module, uint typeId);

        /// <summary>
        /// Gets the names of all fields of the specified type.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="typeId">The type identifier.</param>
        string[] GetTypeFieldNames(Module module, uint typeId);

        /// <summary>
        /// Gets the field type id and offset of the specified type.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="typeId">The type identifier.</param>
        /// <param name="fieldName">Name of the field.</param>
        Tuple<uint, int> GetTypeFieldTypeAndOffset(Module module, uint typeId, string fieldName);

        /// <summary>
        /// Gets the name of the specified type.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="typeId">The type identifier.</param>
        string GetTypeName(Module module, uint typeId);

        /// <summary>
        /// Gets the element type of the specified type.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="typeId">The type identifier.</param>
        uint GetTypeElementTypeId(Module module, uint typeId);

        /// <summary>
        /// Gets the size of the specified type.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="typeId">The type identifier.</param>
        uint GetTypeSize(Module module, uint typeId);

        /// <summary>
        /// Gets the global variable address.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="globalVariableName">Name of the global variable.</param>
        ulong GetGlobalVariableAddress(Module module, string globalVariableName);

        /// <summary>
        /// Gets the global variable type identifier.
        /// </summary>
        /// <param name="module">The module.</param>
        /// <param name="globalVariableName">Name of the global variable.</param>
        uint GetGlobalVariableTypeId(Module module, string globalVariableName);
    }
}
